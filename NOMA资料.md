# 上行 NOMA 用户分组

在上行 NOMA 中，所有用户的信号都有不同的信道增益。基站执行 SIC 要求保持接收到信号的差异性。与下行 NOMA 相反，在一个组内，任何用户的功率控制都不会增加组内其他用户的功率预算。上行 NOMA 中，高信道增益用户不会影响到低信道增益用户。高信道增益用户用其最大功率进行发送。

## (1) 穷尽搜索用户分组方案

穷尽搜索算法顾名思义就是穷举。在算法执行的过程中，需要先确定用户分组的规则，接着根据这个规则将系统内所有的用户进行分组，通过穷举法列出所有可能的用户分组组合，然后分别计算这些不同的分组方案所能获得的系统性能，对计算出的结果进行排序，最后得到最佳的用户分组方案。经过以上的过程虽然可以得到有利于系统性能的最优解，但难以应用于实际。影响该算法复杂度的因素有子信道数以及每个子信道里的用户数。当每个子信道里面的用户数很多时，算法的复杂度也呈指数型增长。

由此可知该算法可得出最优解，当做对照组进行理论分析时可以派上用场。

## (2) 随机用户分组方案

随机用户分组的实现非常简单，在不考虑用户信道增益差异的情况之下，根据子信道数以及子信道内最多复用用户数，在所有用户里随机挑选子信道内最多复用用户数的用户放进一个子信道内，接着重复执行，依次为每个子信道分配用户。

在考虑用户信道增益差异的情况下，将所有用户的信道增益按序排列，然后将所有用户分成子信道内最多复用用户数个集合，接着随机挑选每个集合中的一个用户放入一个子信道内，重复执行直至所有用户完成分配。

## (3) 匹配分组算法

匹配分组算法很好理解，$m$个用户要用$n$个子信道，子信道最多复用用户数为$k$，将这$m$个用户按信道增益降序排列并$k$等分，将$k_1$ 到 $k_k$里的第一个元素放进第一个子信道内，然后依序将剩下的元素放进接下来要分配的子信道内，若到最后有余，直接补进第$n$个子信道，不足无需置理。

匹配分组算法既保证了用户组内的信道状态差异，也考虑了算法复杂度的一方面，是个次优算法。

# NOMA 关键技术——功率分配

NOMA 中发送端对需要发送给用户的信息进行重叠编码，然后将编码后得到的信号发送给各个用户。在发送信号时，会根据用户的信道增益状态给用户分配不同的功率，接收端根据功率的不同来甄别自己应当接收的信号。因此，为各用户分配的功率仅取决于用户的信道状态。

NOMA 中的功率分配不仅影响到用户信号的检测次序，还与整个系统的可靠性和有效性息息相关。本节介绍三种传统常用功率分配算法：遍历搜索功率分配算法（FSPA）、固定功率分配算法（FPA）和分数功率分配算法（FTPA）。

---

## 1. 遍历搜索功率分配算法（FSPA）

同之前用户分组提到的穷尽搜索分组算法，该算法也是量化每种功率分配的性能并选出最佳的功率分配系数。该算法的复杂度和用户数以及步进长度有关，复杂度随着用户数的增多呈指数型增长，随步进长度呈线性增长。

---

## 2. 固定功率分配算法（FPA）

较之遍历搜索算法，固定功率分配算法十分容易实现。该算法将待分配用户的信道增益状态升序排列，然后经由公式 (7-67) 计算每个用户的功率：

$$
\begin{cases}
\sum_{m=1}^M P_m = P \\
P_{m+1} = aP_m
\end{cases}
$$

**公式 (7-67)**

- $P_m$ 是分配给用户 $m$ 的功率；
- $P$ 是总功率；
- $a$ 是设定好的功率分配因子，$0 < a < 1$。

可以看出，随着分配用户数的增加，为信道增益高的用户分配的功率变小，从而达成弱信道用户拥有大功率、强信道用户分配低功率的目的。

该算法的特点：
- 由用户信道状态和功率分配因子 $a$ 决定；
- 无需迭代，分配过程一步完成；
- 性能受功率分配因子的选取影响。

这是一个次优的功率分配算法。

---

## 3. 分数功率分配算法（FTPA）

分数功率分配算法是系统性能与简便性的折衷算法，它充分考虑了信道增益和功率分配之间的关系。可以通过公式 (7-68) 计算为每个用户分配的功率：

$$
\begin{cases}
H_m = \frac{\left|h_m\right|^2}{\sigma_m^2} \\
P_m = \frac{\left[(H_m)^{-\alpha}P\right]}{\sum_{i=1}^M (H_i)^{-\alpha}} \\
\sum_{m=1}^M P_m = P
\end{cases}
$$

**公式 (7-68)**

- $P$ 是可分配的总功率；
- $P_m$ 是分配给用户 $m$ 的功率；
- $\alpha$ 是人为定义的衰减因子，$0 \leq \alpha \leq 1$；
- $H_m$ 是用户 $m$ 的信道增益；
- $\sigma_m^2$ 是噪声功率。

可以看出：
- 当 $\alpha = 0$ 时，功率在用户间平均分配；
- 随着 $\alpha$ 增大，为弱信道增益用户分配的功率增加。

FTPA 是一种次优的功率分配算法，其特点是根据用户的信道增益动态调整功率分配因子，性能优于 FPA，但复杂度低于 FSPA。

---

## 三种经典功率分配算法对比

- **FSPA**：能获得最优解，但复杂度过高，难以应用于实际。
- **FPA**：实现简单，但牺牲了系统性能。
- **FTPA**：性能和复杂度的折衷方案，动态分配功率因子，性能优于 FPA，但仍与最优解存在差距。